import{createSSRApp as t}from"vue";import"./vue-compat/index-vue3.js";import{warn as e}from"./warn.js";import r from"instantsearch.js/es/index.js";function n(e,r){void 0===r&&(r={});var n=r.mixins;void 0===n&&(n=[]);var s,o={serverPrefetch:void 0,fetch:void 0,_base:void 0,name:"ais-ssr-root-component"},i=Object.assign({},e.$options,o);return i.mixins=n.concat(i.mixins||[]),s=t(i),e.$router&&s.use(e.$router),e.$store&&s.use(e.$store),s.$slots=e.$slots,s.$root=e.$root,s}function s(t,n){var s,o=r(t);return o.findResultsState=function(t){var e,r,i=t.component,a=t.renderToString;if(!a)throw new Error("findResultsState requires `renderToString: (component) => Promise<string>` in the first argument.");return Promise.resolve().then(function(){e=n(i,{mixins:[{beforeCreate:function(){var t=Object.getOwnPropertyDescriptor(i,"$nuxt"),e=!!t&&(t.writable||t.set);i.$nuxt&&e&&(this.$nuxt=i.$nuxt)},created:function(){(r=this.instantsearch).start(),r.started=!1}}]})}).then(function(){return a(e)}).then(function(){return t=r.mainHelper,new Promise(function(e,r){t.searchOnlyWithDerivedHelpers(),t.derivedHelpers[0].on("result",function(){e()}),t.derivedHelpers.forEach(function(t){return t.on("error",function(t){r(t)})})});var t}).then(function(){return s={},function t(e,r){return r(e),e.getWidgets().forEach(function(e){"ais.index"===e.$$type&&(r(e),t(e,r))})}(r.mainIndex,function(t){var e=t.getResults(),r=e._state,n=e._rawResults;s[t.getIndexId()]={state:Object.keys(r).reduce(function(t,e){return t[e]=r[e],t},{}),results:n}}),o.hydrate(s),o.getState()})},o.getState=function(){if(!s)throw new Error("You need to wait for findResultsState to finish");return s},o.__forceRender=function(t,e){var r=e.getResults();if(null!==r){var n=r._state,s=e.getHelper();s.state=n,t.render({helper:s,results:r,scopedResults:e.getScopedResults(),parent:e,state:n,templatesConfig:{},createURL:e.createURL,instantSearchInstance:o,searchMetadata:{isSearchStalled:!1}})}},o.hydrate=function(t){t?(o._initialResults=t,o.start(),o.started=!1):e("The result of `findResultsState()` needs to be passed to `hydrate()`.")},o}function o(t){void 0===t&&(t={});var e=t.$cloneComponent;void 0===e&&(e=n);var r=s(t,e);return{provide:function(){return{$_ais_ssrInstantSearchInstance:this.instantsearch}},data:function(){return{instantsearch:r}}}}export{o as createServerRootMixin};
//# sourceMappingURL=createServerRootMixin.js.map
